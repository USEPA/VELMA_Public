<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"><meta name="charset" content="utf-8"><link rel="stylesheet" type="text/css" href="/style.css"><title> </title></head><body class="bg-primary"><div class="header blue-base"><nav class="navbar blue-base navbar-expand"><a class="navbar-brand" href="/index.html">VELMA 2.2 HOME</a><ul class="navbar-nav no-bullets"><li class="nav-item"><a class="nav-link" href="/intro.html"><span>I. Intro</span></a></li><li class="nav-item"><a class="nav-link" href="/changes.html"><span>II. Changes from 1.0</span></a></li><li class="nav-item"><a class="nav-link" href="/about.html"><span>III. About</span></a></li><li class="nav-item"><a class="nav-link" href="/input_files.html"><span>IV. Input Files </span></a></li><li class="nav-item"><a class="nav-link" href="/new_sim_config.html"><span>V. Sim Config</span></a></li><li class="nav-item"><a class="nav-link" href="/parameter_config.html"><span>VI. Parameter Config</span></a></li><li class="nav-item dropdown">Appendicies<ul class="nav-dropdown blue-light"><li class="nav-item"><a class="nav-link" href="/appendix_1.html"><span>Appendix 1</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_2.html"><span>Appendix 2</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_3.html"><span>Appendix 3</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_4.html"><span>Appendix 4</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_5.html"><span>Appendix 5</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_6.html"><span>Appendix 6</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_7.html"><span>Appendix 7</span></a></li></ul></li><li class="nav-item dropdown">Supplemental <ul class="nav-dropdown blue-light"><li class="nav-item"><a class="nav-link" href="/supplement-a1.html"><span>Supplement A1</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-a2.html"><span>Supplement A2</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-a3.html"><span>Supplement A3</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-a4.html"><span>Supplement A4</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b1.html"><span>Supplement B1</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b2.html"><span>Supplement B2</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b3.html"><span>Supplement B3</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b4.html"><span>Supplement B4</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b5.html"><span>Supplement B5</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b6.html"><span>Supplement B6</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b7.html"><span>Supplement B7</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b8.html"><span>Supplement B8</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b9.html"><span>Supplement B9</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b10.html"><span>Supplement B10</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-c1.html"><span>Supplement C1</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-c2.html"><span>Supplement C2</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-c3.html"><span>Supplement C3</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d1.html"><span>Supplement D1</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d2.html"><span>Supplement D2</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d3.html"><span>Supplement D3</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d4.html"><span>Supplement D4</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d5.html"><span>Supplement D5</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d6.html"><span>Supplement D6</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d7a.html"><span>Supplement D7a</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d7b.html"><span>Supplement D7b</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d8.html"><span>Supplement D8</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d9.html"><span>Supplement D9</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d10.html"><span>Supplement D10</span></a></li></ul></li><li class="nav-item dropdown"> <a class="nav-link" href="/dev_info.html"><span>Developer Info</span></a><ul class="nav-dropdown blue-light"><li class="nav-item"><a class="nav-link" href="/GetVelma_ForEclipse.html"><span>Clone Github to Local Machine</span></a></li><li class="nav-item"><a class="nav-link" href="/CellSpecificBurnDisturbance_Configuration_Guide.html"><span>Cell Specific Burn Disturbance Config Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/Configuration_Checker_Guide.html"><span>Configuration Checker Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/DefaultSedimentModel_Configuration_Guide.html"><span>Default Sediment Model Config Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/Sediment_Output_Data_Summary.html"><span>Sediment Output Data Summary</span></a></li><li class="nav-item"><a class="nav-link" href="/ForestBurnLsrDisturbanceModel_Overview.html"><span>Forest Burn LSR Disturbance Model</span></a></li><li class="nav-item"><a class="nav-link" href="/JPDEM_ReachMapping_Demonstration.html"><span>JPDEM Reaching Mapping Demo</span></a></li><li class="nav-item"><a class="nav-link" href="/MinMaxAirT_WeatherDrivers.html"><span>Min Max Air Temp Weather Drivers</span></a></li><li class="nav-item"><a class="nav-link" href="/ModifySpatialDataByMap_Guide.html"><span>Modify Spatial Data by Map Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/ObsRunoff_and_NaNs.html"><span>OBS Runnoff and NaNs</span></a></li><li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Overview.html"><span>Organic Contaminant Overview</span></a></li><li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Remediation_Configuration_Guide.html"><span>Organic Contaminant Redemption Config Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Tracer_Configuration_Guide.html"><span>Organic Contaminant Tracter Config Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/ReachSpecificObservedRunnoff.html"><span>Reach Specific Observed Runnoff</span></a></li><li class="nav-item"><a class="nav-link" href="/SnowDepth_Initialization_Guide.html"><span>Snow Depth Initialization Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/TopoFiles_Output_Summary.html"><span>Topo Files Output Summary </span></a></li><li class="nav-item"><a class="nav-link" href="/VelmaParallel_Error_Reports.html"><span>Velma Parallel Error Reports</span></a></li><li class="nav-item"><a class="nav-link" href="/VelmaParallel_With_Multiple_Maps.html"><span>Velma Parallel With Multiple Maps </span></a></li><li class="nav-item"><a class="nav-link" href="/WaterDrainDisturbanceModel_Overview.html"><span>Water Drain Disturbance Model</span></a></li><li class="nav-item"><a class="nav-link" href="/VelmaSimulatorCmdLine_Overview.html"><span>Velma Sim Cmd Line Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/VelmaSimulatorAltCmdLine_Overview.html"><span>Velma Sim Alt Cmd Line Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/SurfaceEvaporation_Overview.html"><span>Surface Evaporation Overview</span></a></li></ul></li><li class="nav-item dropdown"> <a class="nav-link" href="/dev_utils.html"><span>Developer Utils</span></a><ul class="nav-dropdown blue-light"><li class="nav-item"><a class="nav-link" href="/AscMapOct_Guide.html"><span>Ascii Map Oct Guide </span></a></li><li class="nav-item"><a class="nav-link" href="/AscRangeMask_Guide.html"><span>Ascii Range Mask Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/MoeVelGenerator_Guide.html"><span>MOEA-to-VELMA Configuration Generator</span></a></li><li class="nav-item"><a class="nav-link" href="/NashSutcliffeCalculator_Guide.html"><span>Tool for Computing Nash-Sutcliffe Coefficients</span></a></li><li class="nav-item"><a class="nav-link" href="/NseQuarts_Guide.html"><span>NseQuarts Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/VelmaSimRunner_QuickRef.html"><span>VelmaSimRunner Quick Reference</span></a></li><li class="nav-item"><a class="nav-link" href="/VelmaSimRunner.html"><span>VelmaSimRunner Full Guide</span></a></li></ul></li></ul></nav></div><div class="main_body container"><h1>AscMapOct Guide</h1><h2>Overview</h2><p>The <code>AscMapOct.py</code> utility script combines the values of two Grid ASCII (.asc) map files, a source map and a destination map, to produce a new map with the dimensions and values of the destination map, but with the values of the source map for any cell locations that overlap between the two maps.</p><p><code>AscMapOct.py</code> was written to assist JPDEM flat-processing of large DEM maps. JDPEM may require very long running times to flat-process DEM maps with large dimensions. An experimental method for dealing with that issue is to create multiple, smaller sub-maps from the single, original large map. If the sub-maps are created with due regard for the overall topography, and all of them satisfy the <code>AscMapOct.py</code> <a>limitations</a> listed below, then they may be flat-processed individually. However, to use them to replicate the original, full map, they must be flat-processed in order, from lowest (by elevation) to highest sub-map, and the overlapping cell values for adjacent maps must be transferred from flat-processed to un-processed maps during the overall flat-processing sequence. <code>AscMapOct.py</code> provides a way to perform this transfer step.</p><blockquote><p>Note: <code>AscMapOct.py</code> has many <a>limitations</a>, and is not the only way transfer overlapping cell values.<br> JPDEM users with sufficient GIS experience may wish to employ a GIS tool of their choice instead.</p></blockquote><h4><strong>Requirements</strong></h4><ul><li>A Windows Powershell or Command Prompt.</li><li>Python 3 installed and available.</li><li>A source ASCII Grid (.asc) map file.</li><li>A destination ASCII Grid (.asc) map file.</li></ul><h4><strong>Limitations</strong></h4><p>The source and destination files must ...</p><ul><li>overlap by a region of at least 3x3 cells.</li><li>be cell-aligned and from the same UTM zone.</li><li>have the same header cellsize value (and, implicity the same unit for that value).</li><li>must use <code>xllcorner</code> and <code>yllcorner</code>, <em>not</em> <code>xllcenter</code> and <code>yllcenter</code>.</li><li>Custom border overlays are <em>not</em> permitted.</li></ul><blockquote><p>Note: "cell-aligned" means that the file's grids are cell-boundary aligned: i.e. the values of:<br> <code>(abs(source_xll - destination_xll) / cellsize)</code><br> and<br> <code>(abs(source_yll - destination_yll) / cellsize)</code><br> are both integers.</p></blockquote><h2>Usage</h2><p>Open a Windows Powershell or Command Prompt and type the following command:</p><pre><code>py -3 AscMapOct.py --help</code></pre><p>Depending upon where the <code>AscMapOct.py</code> script is located, you may need to include full or partial path info as part of its name.<br> The command above assumes it is being run in the directory where <code>AscMapOct.py</code> is located.<br> Running the command above echoes <code>AscMapOct.py's</code> help message to your console:</p><pre><code>usage: AscMapOct.py [-h] [--lint] [--output_asc_file OUTPUT_ASC_FILE] source_asc_file destination_asc_file
Transfers overlapping cell values from source_asc_file to destination_asc_file.
positional arguments:
  source_asc_file       Grid .asc file to copy values from.
  destination_asc_file  Grid .asc file to merge source values with.
optional arguments:
  -h, --help            show this help message and exit
  --lint                Checks if source can transfer to destination; doesn't actually transfer values.
  --output_asc_file OUTPUT_ASC_FILE
                        Grid .asc file to write merged values to.</code></pre><p>Per the help message above:</p><ol><li><p>You must specify source ASCII Grid (.asc) file. The file is assumed to have already been flat-processed by JPDEM, and to have standard (outermost rows and columns) cell border, but <code>AscMapOct.py</code> does not verify either of these assumptions.</p></li><li><p>You must specify a destination ASCII Grid (.asc) file. The file is assumed to be "raw" data -- i.e. <em>not</em> already flat-processed by JPDEM, and to have no border, but again, <code>AscMapOct.py</code> does not verify either of these assumptions.</p></li></ol><p><code>AscMapOct.py</code> doesn't modify either the source or destination files in either way. Instead it outputs a combination of the two files to the console. The output will have the header values of the destination file, but overlapping cells will have the values from the source file.</p><h2>Example Usage</h2><blockquote><p>Remember: you will typically need to include paths in the file names. Paths have been omitted in this example to keep the command line compact, but typically, the AscMapOct.py file will not be co-located with the data you are processing.</p></blockquote><p>The following example transfers overlapping values from source file all_ones_border-zero_9x7.asc:</p><pre><code>PS C:\Users\Me\Velma\My_Results> Get-Content .\all_ones_border-zero_9x7.asc
ncols 9
nrows 7
cellsize 3.0
xllcorner 0.0
yllcorner 0.0
nodata_value -9999.0
0 0 0 0 0 0 0 0 0
0 1 1 1 1 1 1 1 0
0 1 1 1 1 1 1 1 0
0 1 1 1 1 1 1 1 0
0 1 1 1 1 1 1 1 0
0 1 1 1 1 1 1 1 0
0 0 0 0 0 0 0 0 0</code></pre><p>to the destination file all_twos_9x7.asc:</p><pre><code>PS C:\Users\Me\Velma\My_Results> Get-Content .\all_twos_9x7.asc
ncols 9
nrows 7
cellsize 3.0
xllcorner 12.0
yllcorner 6.0
nodata_value -9999.0
2 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2</code></pre><blockquote><p>Note: <a><code>Get-Content</code></a> is a Powershell command that echoes the contents of a file to the Powershell console.</p></blockquote><p>The destination file's <code>xllcorner</code> and <code>yllcorner</code> values indicate that it is offset above and to the right of the source file. When we run <code>AscMapOct.py</code> on this pair of files, we should see section of "1.0" values in the lower-left corner of the output, and the output should retain the destination file's header values.</p><pre><code>PS C:\Users\Me\Velma\My_Results> py -3 AscMapOct.py .\all_ones_border-zero_9x7.asc .\all_twos_9x7.asc
ncols 9
nrows 7
cellsize 3.0
xllcorner 12.0
yllcorner 6.0
nodata_value -9999.0
2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0
2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0
2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0
1.0 1.0 1.0 1.0 2.0 2.0 2.0 2.0 2.0
1.0 1.0 1.0 1.0 2.0 2.0 2.0 2.0 2.0
1.0 1.0 1.0 1.0 2.0 2.0 2.0 2.0 2.0
1.0 1.0 1.0 1.0 2.0 2.0 2.0 2.0 2.0</code></pre><p>The above output is what we expected. Notice that the border cells (all set to zero) of the source map were not transferred. This is by design: the outermost rows and columns of the source map (whatever their values) are not transferred.</p><h2>Command Line Options</h2><h3>--lint</h3><p>When invoked, the first thing <code>AscMapOct.py</code> does is verify the specified .asc files.<br> The verification steps performed are:</p><ol><li>source and destination cellsize values are the same.</li><li>source and destination maps are cell-aligned.</li><li>source and destination have overlapping cell area.</li><li>source map header dimensions match and data length.</li><li>destination map header dimensions match and data length.</li><li>when <code>--output_asc_file</code> is present, whether the output file it specifies already exists.</li></ol><p>Including <code>--lint</code> on the command line tells <code>AscMapOct.py</code> to stop immediately after performing these verification steps, and report the first verification step that failed. If no problems are detected, a <code>--lint</code>-optioned command line returns without any output at all.</p><p>Some problems are not dectected during the verification steps, and are thus not part of what <code>--lint</code> can check:</p><ul><li>Map files whose headers employ <code>xllcenter</code> and <code>yllcenter</code> instead of <code>xllcorner</code> and <code>yllcorner</code> cause a failure as their contents are loaded -- i.e. before <code>AscMapOct.py</code> runs its verification tests.</li><li>The overlap test is for <em>any</em> overlap, not the minimum adequate overlap area specified by the script's <a>limitations</a>.</li><li>If the bounding-box overlap area for the source map does not equal the bounding-box overlap area for the destination map, the script fails with an error message. The portion of the script that computes the overlap bounding boxes runs after the verification steps, and so is not included when <code>--lint</code> is run. (Note: maps with proper cell-alignment are unlikely to fail for this reason.)</li></ul><h3>--output_asc_file</h3><p>Specifies the file that <code>AscMapOct.py</code> writes its results to.<br> If the <code>--output_asc_file</code> option is not specified, <code>AscMapOct.py</code> outputs results directly to your console. Writing to the console is useful for checking what the results look like before running the script "for real", but when running the script "for real", specifying the <code>--output_asc_file</code> option is the simplest way to save the results.</p><blockquote><p>Note: <code>AscMapOct.py</code> does not permit you to overwrite an existing file.<br> If you specify a file that already exists as the argument for the <code>--output_asc_file</code> option, the script fails with an error message.<br> If you want to "reuse" that output file, you must delete it before running <code>AscMapOct.py</code> and specfiying it again.</p></blockquote><p>Here is the Usage example, plus the <code>--output_asc_file</code> option:console itself:</p><pre><code>PS C:\Users\Me\Velma\My_Results> py -3 AscMapOct.py .\all_ones_border-zero_9x7.asc .\all_twos_9x7.asc --output_asc_file overlap_map.asc</code></pre><blockquote><p>Note: You can "pair" the file to the option with either a whitespace (" ") or and equals ("=") character.<br> Either <code>--output_asc_file overlap_map.asc</code> or <code>--output_asc_file=overlap_map.asc</code> is acceptable for the above example.</p></blockquote><p>Running the example command line above writes the script's results to the file "overlap_map.asc".</p><p>It is possible ignore the the <code>--output_asc_file</code> option and capture <code>AscMapOct.py</code> results into a file using only console commands, but it requires a longer command line and more knowledge of the console command language. In compensation, it also allows you specify the file's character encoding, and to easily overwrite a pre-existing output file (an unsafe "benefit").</p><p>As an example: for Windows PowerShell, we recommend capturing the output via a <a>pipeline</a> combined with the PowerShell <a>Out-File</a> cmdlet.<br> Here is the Usage example, plus the additional command line syntax to capture the output to a file named "overlap_map.asc" instead of to the console itself:</p><pre><code>PS C:\Users\Me\Velma\My_Results> py -3 AscMapOct.py .\all_ones_border-zero_9x7.asc .\all_twos_9x7.asc | Out-File -Encoding ASCII -FilePath overlap_map.asc</code></pre><p>The pipe ("<code>|</code>") symbol tells PowerShell to take the output of command on its left (the <code>AscMapOct.py</code> command) and pass it to the command its right (the <code>Out-File</code> cmdlet).</p><p>The <code>Out-File</code> cmdlet can be used in various ways and for various situations, but what we want it to do here is:</p><ol><li>Force the output to be ASCII-encoded.</li><li>Save the output to the file "overlap_map.asc" specified by the <code>-FilePath</code> argument.</li></ol><p>We force the output to be ASCII because <a>PowerShell's default encoding is Unicode</a>.<br> If you omit the <code>-Encoding ASCII</code> argument, the output is written to the file as Unicode characters.<br> If you find you don't need the <code>-Encoding ASCII</code> option, feel free to omit it.</p></div></body><footer id="footer"><p>VELMA 2.2 DOCUMENTATION</p></footer></html>